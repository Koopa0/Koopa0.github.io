# 功能重新設計提案

## 🎯 設計原則

1. **專注核心價值**：知識管理 + 內容發布
2. **單一來源**：Obsidian 作為唯一的外部整合工具
3. **功能一致性**：確保每個功能都完整實作並相互配合
4. **避免功能膨脹**：只保留真正需要的功能

---

## ✅ 核心功能集

### 1. 知識管理核心

#### 1.1 頁面管理
- **狀態**: ✅ 已實作
- **功能**:
  - CRUD 操作（建立、讀取、更新、刪除）
  - 搜尋與篩選（標題、標籤、分類）
  - 發布狀態管理（草稿、已發布、已封存）
  - 圖示與 emoji 支援

#### 1.2 Obsidian 整合
- **狀態**: ✅ Phase 1 完成
- **功能**:
  - ZIP 匯入（Markdown 檔案）
  - Frontmatter 解析
  - Wikilink 轉換 `[[Page]]` → 內部連結
  - 標籤擷取（frontmatter + #hashtag）
- **待實作**:
  - Wikilink 雙向連結追蹤 (Backlinks)
  - 匯出為 Obsidian 格式
  - 知識圖譜視覺化

#### 1.3 標籤系統
- **狀態**: ✅ 基礎已實作
- **功能**:
  - 多標籤支援
  - 標籤過濾
  - 標籤統計
- **待增強**:
  - 標籤管理頁面（重命名、合併、刪除）
  - 標籤層級（可選）

---

### 2. 內容創作

#### 2.1 富文本編輯器 (Tiptap)
- **狀態**: ✅ 已實作
- **功能**:
  - 文字格式（粗體、斜體、刪除線、程式碼）
  - 標題（H1-H6）
  - 清單（項目、編號、引用）
  - 程式碼區塊（語法高亮）
  - 表格
  - 連結、圖片
  - Markdown 相容（透過 MarkdownConverter）

#### 2.2 圖表支援
- **狀態**: ✅ Mermaid 已實作
- **功能**:
  - Mermaid 程式碼圖表（流程圖、時序圖、類別圖等）
  - 主題支援
- **可選**: Excalidraw 手繪風格（如有需求再加）

---

### 3. AI 輔助

#### 3.1 AI Chat
- **狀態**: ✅ 已實作
- **功能**:
  - NotebookLM 風格的對話介面
  - 引用來源頁面（Citations）
  - 可點擊跳轉到來源
  - 對話歷史管理
  - 後續問題建議

#### 3.2 AI 功能擴展（未來）
- 頁面自動摘要
- 相關頁面推薦
- 智慧標籤建議
- 內容品質檢查

---

### 4. 內容發布

#### 4.1 Blog 功能
- **狀態**: ✅ 已實作
- **功能**:
  - 公開部落格列表
  - 文章詳情頁面
  - 標籤分類瀏覽
  - 系列文章（Series）
  - RSS Feed
  - Sitemap

#### 4.2 發布流程
- **狀態**: ✅ 基礎已實作
- **功能**:
  - 一鍵發布（Workspace → Blog）
  - 發布狀態管理
  - SEO 設定（標題、描述、Open Graph）
- **待增強**:
  - 預覽模式
  - 排程發布（可選）

---

## ❌ 移除的功能

### ~~Notion 整合~~
- **理由**: 與 Obsidian 功能重複
- **狀態**: 只有提案文件，未實作
- **決策**: 完全移除，專注於 Obsidian

### ~~Learning Paths~~
- **理由**: 功能過於複雜，可用標籤/系列文章替代
- **狀態**: 只有 API 定義，未實作
- **決策**: 移除，使用現有的「系列文章」功能

### ~~社交功能~~
- **理由**: 個人使用，不需要社交功能
- **狀態**: 未規劃
- **決策**: 不實作

### ~~訂閱/付費功能~~
- **理由**: 個人使用，不需要營利功能
- **狀態**: 未規劃
- **決策**: 不實作

---

## 🏗️ 簡化後的系統架構

```
┌─────────────────────────────────────────────────────────┐
│                      使用者介面                          │
├─────────────────────────────────────────────────────────┤
│  Public Blog         │      Workspace (Private)         │
│  ├─ Blog List        │      ├─ Dashboard                │
│  ├─ Blog Detail      │      ├─ Pages (CRUD)            │
│  ├─ Tags             │      ├─ AI Chat                 │
│  ├─ Series           │      └─ Obsidian Import         │
│  └─ About            │                                   │
└─────────────────────────────────────────────────────────┘
                            ▼
┌─────────────────────────────────────────────────────────┐
│                      核心服務層                          │
├─────────────────────────────────────────────────────────┤
│  PageService         │  AiChatService                   │
│  ObsidianService     │  MarkdownConverterService        │
│  AuthService         │  BlogService                     │
└─────────────────────────────────────────────────────────┘
                            ▼
┌─────────────────────────────────────────────────────────┐
│                      資料層                              │
├─────────────────────────────────────────────────────────┤
│  PostgreSQL                                              │
│  ├─ users                                                │
│  ├─ pages                                                │
│  ├─ page_links (backlinks)                              │
│  ├─ conversations                                        │
│  └─ blog_posts (published pages)                        │
└─────────────────────────────────────────────────────────┘
```

---

## 📋 實作優先序

### Phase 1 - 已完成 ✅
- [x] 基礎認證
- [x] 頁面 CRUD
- [x] Tiptap 編輯器
- [x] Mermaid 圖表
- [x] AI Chat
- [x] Obsidian 匯入 (ZIP)
- [x] Markdown ↔ Tiptap 轉換

### Phase 2 - 短期（1-2週）
- [ ] Wikilink 雙向連結 (Backlinks)
  - 追蹤頁面間的連結
  - Backlinks 面板
  - 連結驗證（檢查斷鍊）

- [ ] 標籤管理頁面
  - 所有標籤列表
  - 標籤重命名
  - 標籤合併

- [ ] Obsidian 匯出
  - 匯出單一頁面為 .md
  - 批次匯出為 ZIP
  - 保留 wikilinks 格式

### Phase 3 - 中期（2-3週）
- [ ] 知識圖譜視覺化
  - 頁面連結關係圖
  - 互動式節點
  - 篩選與搜尋

- [ ] 搜尋增強
  - 全文搜尋
  - 搜尋建議
  - 進階過濾

### Phase 4 - 長期（可選）
- [ ] AI 功能擴展
  - 頁面摘要
  - 相關推薦
  - 智慧標籤

- [ ] 協作功能（如需要多使用者）
  - 權限管理
  - 分享連結

---

## 🗑️ 清理項目

### 立即移除
1. **文件**:
   - `/docs/notion-integration.md` - Notion 整合提案
   - `/docs/learning-paths-api.md` - Learning Paths API（如存在）

2. **程式碼**:
   - 移除 workspace sidebar 中的 "Learning Paths" 連結
   - 移除 routes 中的 learning-paths 註解

3. **API 定義**:
   - 清理 mock-data.service 中未使用的 learning paths 端點

---

## 🎯 統一的資料流

### Obsidian → Platform → Blog

```
Obsidian Vault (.md files)
         ↓
    ZIP 匯入
         ↓
    解析 + 轉換
    ├─ Frontmatter → Metadata
    ├─ Wikilinks → Internal Links
    ├─ #tags → Tags
    └─ Markdown → Tiptap JSON
         ↓
    Pages (Database)
         ↓
    編輯 + AI 輔助
         ↓
    發布 → Blog Posts
         ↓
    靜態網站生成
```

---

## 💡 核心價值主張

### 對於個人使用者
1. **本地優先**: Obsidian 作為主要知識庫，平台作為雲端同步 + 發布工具
2. **AI 輔助**: 透過 AI 深入理解和探索自己的知識庫
3. **無縫發布**: 一鍵將筆記轉換為美觀的 Blog 文章
4. **連結追蹤**: 自動追蹤 backlinks，建立知識網絡
5. **視覺化**: 知識圖譜讓想法之間的關聯一目了然

---

## 📊 功能對比表

| 功能 | Obsidian | 本平台 | 整合效果 |
|-----|---------|--------|---------|
| Markdown 編輯 | ✅ 強大 | ✅ Tiptap | 雙向同步 |
| Wikilinks | ✅ 原生 | ✅ 支援 | 完美對應 |
| 圖表 | ⚠️ Plugin | ✅ Mermaid | 增強功能 |
| AI 對話 | ❌ | ✅ NotebookLM風格 | 獨特價值 |
| Blog 發布 | ⚠️ Plugin | ✅ 原生 | 主要優勢 |
| 雲端同步 | 💰 付費 | ✅ 免費 | 成本優勢 |
| 協作 | ❌ | 🔜 可擴展 | 未來可能 |

---

## ✅ 結論

**精簡後的系統更加專注**:
- ✅ 移除重複功能（Notion）
- ✅ 移除過度設計（Learning Paths）
- ✅ 強化核心價值（Obsidian + AI + Blog）
- ✅ 確保功能一致性和完整性

**下一步行動**:
1. 移除不需要的文件和程式碼
2. 實作 Backlinks 功能（Phase 2 優先）
3. 完善 Obsidian 雙向整合（匯入 + 匯出）
4. 實作知識圖譜視覺化

這個設計確保了平台有明確的定位：**以 Obsidian 為核心的個人知識管理與發布平台**。
